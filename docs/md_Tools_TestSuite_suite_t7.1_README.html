<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>fdtd3d: Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fdtd3d
   &#160;<span id="projectnumber">0.5</span>
   </div>
   <div id="projectbrief">FDTD multi-dimensional solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is test with plane wave in vacuum in 1D mode with PML border condition and optional dielectric in total field area.</p>
<p>Numerical solution is compared with analytical both in terms of amplitude and phase. <code>ExHy</code> 1D mode is used.</p>
<h1>Detailed Description</h1>
<ul>
<li>PML is set on both sides of grid</li>
<li><b>only left TF/SF border is used</b>, i.e. scattered field exists to the left of border, total field exists to the right</li>
<li>incident wave goes from vacuum on the left side to the material on the right side, which can be either <code>Eps=4</code> or vacuum itself (<code>Eps=1</code>); <code>Mu=1</code> for all cases</li>
<li>incident wave (E1, H1), refracted wave (E2, H2), reflected wave (E3, H3)</li>
</ul>
<p>Example of grid layout with material with <code>Eps=4</code>: </p><div class="image">
<img src="grid.png"  alt="Grid layout"/>
</div>
<h1>Analytical solution</h1>
<h2>Case of material with <code>Eps=1</code></h2>
<p>In this case no reflection happens, i.e. wave passes without changes </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;E2 = H2 = 0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;E3 = E1</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;H3 = H1</div></div><!-- fragment --><h2>Case of material with <code>Eps=4</code></h2>
<p>In this case wave is refracted and reflected. Let Oz axis be set and z1 be coordinate of border between vacuum and material.</p>
<p>Incident wave </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;E1 = i * e^(i*k*(z-z0) - i*w*(t-t0))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;t0 = 0.5 * dt</div></div><!-- fragment --><p>t0 is 0.5 of dt due to the fact that incident wave calculation starts at half of the first time step. z0 is the start coordinate of incident wave (depend on the coordinate, at which auxiliary TF/SF grid is set up).</p>
<p>In order to obtain refracted and reflected wave border conditions at <code>z=z1</code> are considered. Reflection index is <code>n=sqrt(eps*mu)=2</code>. As the wave vector is orthogonal to border, no angle changes arise. That leads to next fields:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;E2 = -1/3 * i * e^(-i*k*z + i*k*(2*z1-z0) - i*w*(t-t0))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;E3 = 2/3 * i * e^(i*k_2*z - i*k_2*0.5*(z1 + z0) - i*w*(t-t0))</div></div><!-- fragment --><p>For all the fields: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;H = k/(Mu*Mu0*w) * E = k/(Mu0 * w) * E</div></div><!-- fragment --><h1>Numerical Result</h1>
<p>Norm of difference between exact and numerical solution is calculated. For both cases amplitude and real/imaginary parts accuracy is less than 0.7% for PML size 20 and less than 0.17% for PML size 50 (see next configs for examples: <a href="sphere1D_vacuum.txt">vacuum</a> and <a href="sphere1D_eps4.txt">material</a>)</p>
<h2>Case of material with <code>Eps=1</code></h2>
<p>Amplitude of E field (TF/SF border at grid point 150, PML size is 20): </p><div class="image">
<img src="E_amplitude_vacuum.png"  alt="Grid layout"/>
</div>
<p>Amplitude of E field (TF/SF border at grid point 150, PML size is 50): </p><div class="image">
<img src="E_amplitude_vacuum_pml50.png"  alt="Grid layout"/>
</div>
<h2>Case of material with <code>Eps=4</code></h2>
<p>Amplitude of E field (TF/SF border at grid point 150, PML size is 20, border between vacuum and material at 300): </p><div class="image">
<img src="E_amplitude_eps4.png"  alt="Grid layout"/>
</div>
<p>Amplitude of E field (TF/SF border at grid point 150, PML size is 50, border between vacuum and material at 300): </p><div class="image">
<img src="E_amplitude_eps4_pml50.png"  alt="Grid layout"/>
</div>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
